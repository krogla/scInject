!function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";n.d(e,"c",function(){return r}),n.d(e,"g",function(){return s}),n.d(e,"e",function(){return i}),n.d(e,"f",function(){return o}),n.d(e,"d",function(){return c}),n.d(e,"j",function(){return a}),n.d(e,"a",function(){return u}),n.d(e,"i",function(){return h}),n.d(e,"h",function(){return d}),n.d(e,"b",function(){return l});const r="error",s="pushScatter",i="getOrRequestIdentity",o="identityFromPermissions",c="forgetIdentity",a="requestSignature",u="abiCache",h="requestArbitrarySignature",d="requestAddNetwork",l="authenticate"},function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return s});const r="injected",s="scatter"},function(t,e,n){"use strict";n.d(e,"a",function(){return r});class r{static rand(){return Math.random()}static text(t){let e="";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let s=0;s<t;s++)e+=n.charAt(Math.floor(r.rand()*n.length));return e}static numeric(t){let e=11;if(t>e)return r.numeric(e)+r.numeric(t-e);const n=(e=Math.pow(10,t+1))/10;return(""+(Math.floor(r.rand()*(e-n+1))+n)).substring(1)}}},function(t,e,n){"use strict";n.d(e,"a",function(){return s});var r=n(0);class s{constructor(t="",e={},n="",r=""){this.type=t,this.payload=e,this.resolver=n,this.domain=r}static placeholder(){return new s}static fromJson(t){return Object.assign(this.placeholder(),t)}static payload(t,e){const n=this.placeholder();return n.type=t,n.payload=e,n}static signal(t){const e=this.placeholder();return e.type=t,e}respond(t){return new s(this.type,t,this.resolver)}error(t){return new s(r.c,t,this.resolver)}}},function(t,e,n){"use strict";n.d(e,"a",function(){return r});const r=()=>{let t=location.hostname;return 0===t.indexOf("www.")&&(t=t.replace("www.","")),t}},function(t,e,n){"use strict";const r="malicious",s="locked",i="prompt_closed";n.d(e,"a",function(){return c});const o={NO_SIGNATURE:402,FORBIDDEN:403,TIMED_OUT:408,LOCKED:423,UPGRADE_REQUIRED:426,TOO_MANY_REQUESTS:429};class c{constructor(t,e,n=o.LOCKED){this.type=t,this.message=e,this.code=n,this.isError=!0}static locked(){return new c(s,"The user's Scatter is locked. They have been notified and should unlock before continuing.")}static promptClosedWithoutAction(){return new c(i,"The user closed the prompt without any action.",o.TIMED_OUT)}static maliciousEvent(){return new c(r,"Malicious event discarded.",o.FORBIDDEN)}static signatureError(t,e){return new c(t,e,o.NO_SIGNATURE)}static identityMissing(){return this.signatureError("identity_missing","Identity no longer exists on the user's keychain")}static signatureAccountMissing(){return this.signatureError("account_missing","Missing required accounts, repull the identity")}static malformedRequiredFields(){return this.signatureError("malformed_requirements","The requiredFields you passed in were malformed")}static noNetwork(){return this.signatureError("no_network","You must bind a network first")}static usedKeyProvider(){return new c(r,"Do not use a `keyProvider` with a Scatter. Use a `signProvider` and return only signatures to this object. A malicious person could retrieve your keys otherwise.",o.NO_SIGNATURE)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r={encrypt:(t,e)=>t,decrypt:(t,e)=>t};class s{constructor(t,e){this.eventName=t,this.key=e,this.synced=!1,this.syncFn=null,this.listenForSync()}listenWith(t){document.addEventListener(this.eventName,e=>{if(!this.synced)return!1;let n=JSON.parse(e.detail);n=this.synced&&"string"==typeof n?r.decrypt(n,this.key):n,t(n)})}send(t,e){if("object"!=typeof t)throw new Error("Payloads must be objects");(()=>{t.from=this.eventName})(),(()=>{t=this.synced?r.encrypt(t,this.key):t})(),this.dispatch(JSON.stringify(t),e)}onSync(t){this.syncFn=t}sync(t,e){this.send({type:"sync",handshake:e},t)}listenForSync(){document.addEventListener(this.eventName,t=>{let e=JSON.parse(t.detail);if(!e.hasOwnProperty("type"))return!1;"sync"===e.type&&this.ackSync(e),"synced"===e.type&&(this.synced=!0)})}ackSync(t){this.send({type:"synced"},t.from),this.key=t.handshake,this.synced=!0,this.syncFn()}dispatch(t,e){document.dispatchEvent(this.getEvent(t,e))}getEvent(t,e){return new CustomEvent(e,this.getEventInit(t))}getEventInit(t){return{detail:t}}}e.EncryptedStream=s,e.default=s},,function(t,e,n){"use strict";n.r(e);var r=n(6),s=n(2),i=n(1),o=n(0),c=n(3);class a{constructor(t="",e="https",n="",r=0,s="eos",i=""){this.name=t,this.protocol=e,this.host=n,this.port=r,this.blockchain=s,this.chainId=i.toString()}static placeholder(){return new a}static fromJson(t){const e=Object.assign(a.placeholder(),t);return e.chainId=e.chainId?e.chainId.toString():"",e}static fromUnique(t){const e=t.split(":")[0];if(t.indexOf(":chain:")>-1)return new a("","","","",e,t.replace(`${e}:chain:`,""));const n=t.replace(`${e}:`,"").split(":");return new a("","",n[0],parseInt(n[1]||80),e)}unique(){return(`${this.blockchain}:`+(this.chainId.length?`chain:${this.chainId}`:`${this.host}:${this.port}`)).toLowerCase()}hostport(){return`${this.host}${this.port?":":""}${this.port}`}fullhost(){return`${this.protocol}://${this.host}${this.port?":":""}${this.port}`}clone(){return a.fromJson(JSON.parse(JSON.stringify(this)))}isEmpty(){return!this.host.length}isValid(){return this.host.length&&this.port||this.chainId.length}}var u=n(5),h=n(4);const d={firstname:"firstname",lastname:"lastname",email:"email",birthdate:"birthdate"},l={phone:"phone",address:"address",city:"city",state:"state",country:"country",zipcode:"zipcode"},p={account:"accounts"};class y{constructor(){this.accounts=[],this.personal=[],this.location=[]}static placeholder(){return new y}static fromJson(t){const e=Object.assign(new y,t);return e.accounts=t.hasOwnProperty("accounts")?t.accounts.map(a.fromJson):[],e}isEmpty(){return!this.accounts.length&&!this.personal.length&&!this.location.length}isValid(){return JSON.stringify(Object.keys(new y))===JSON.stringify(Object.keys(this))&&(!!this.personal.every(t=>Object.keys(d).includes(t))&&(!!this.location.every(t=>Object.keys(l).includes(t))&&!(this.accounts.length&&!this.accounts.every(t=>t.isValid()))))}toFieldsArray(){const t=[];return Object.keys(this).map(e=>{e===p.account?this[e].map(e=>t.push(`ACCOUNT: ${e.unique()}`)):this[e].map(e=>t.push(e))}),t}}let f=new WeakMap,w=new WeakMap;const g=(t,e)=>new Proxy(t,e);var m=(...t)=>(f=t[0],w=t[1],(t,e,n={},r="http")=>{if(!["http","https","ws"].includes(r))throw new Error("Protocol must be either http, https, or ws");if(t.hasOwnProperty("protocol")&&t.protocol.length||(t.protocol=r),!(t=a.fromJson(t)).isValid())throw Error.noNetwork();const s=`${t.protocol}://${t.hostport()}`,i=t.hasOwnProperty("chainId")&&t.chainId.length?t.chainId:n.chainId;return t.chainId=i,g(e({httpEndpoint:s,chainId:i}),{get(r,c){let a=null;return(...r)=>{if(r.find(t=>t.hasOwnProperty("keyProvider")))throw Error.usedKeyProvider();let u=r.find(t=>t.hasOwnProperty("requiredFields"));if(!(u=y.fromJson(u?u.requiredFields:{})).isValid())throw Error.malformedRequiredFields();const d=async e=>{w();const n=Object.assign(e,{domain:Object(h.a)(),network:t,requiredFields:u}),s=await f(o.j,n);if(!s)return null;if(s.hasOwnProperty("signatures")){a=s.returnedFields;const t=r.find(t=>t.hasOwnProperty("signProvider"));return t&&s.signatures.push(t.signProvider(e.buf,e.sign)),s.signatures}return s};return new Promise((t,o)=>{e(Object.assign(n,{httpEndpoint:s,signProvider:d,chainId:i}))[c](...r).then(e=>{if(!e.hasOwnProperty("fc"))return e=Object.assign(e,{returnedFields:a}),void t(e);const n=g(e,{get:(t,e)=>"then"===e?t[e]:(...n)=>new Promise(async(r,s)=>{t[e](...n).then(t=>{r(Object.assign(t,{returnedFields:a}))}).catch(s)})});t(n)}).catch(t=>o(t))})}}})});const O=t=>{throw new u.a(t)};class b{constructor(t,e,n){this.id=t,this.resolve=e,this.reject=n}}let v=new WeakMap,k=new WeakMap;const E=new WeakMap;let I=new WeakMap;const P=()=>{I||O("There is no identity with an account set on your Scatter instance.")},S=()=>{v.listenWith(t=>{if(!t||!t.hasOwnProperty("type"))return!1;for(let e=0;e<k.length;e++)k[e].id===t.resolver&&("error"===t.type?k[e].reject(t.payload):k[e].resolve(t.payload),k=k.slice(e,1))})},j=(t,e)=>new Promise((n,r)=>{console.log(t,e);const o=s.a.numeric(24),a=new c.a(t,e,o);k.push(new b(o,n,r)),v.send(a,i.b)});class N{constructor(t,e){console.log(e),this.useIdentity(e.identity),v=t,k=[],this.eos=m(j,P),S()}useIdentity(t){this.identity=t,I=t?t.publicKey:""}suggestNetwork(t){return a.fromJson(t).isValid()||O("The provided network is invalid."),j(o.h,{network:t})}getIdentity(t={}){return console.log("getIdentity",t),j(o.e,{network:E,fields:t}).then(async t=>(this.useIdentity(t),t))}async authenticate(){P();const t=await j(o.b,{publicKey:I},!0).catch(t=>t);return t}forgetIdentity(){return P(),j(o.d,{}).then(()=>(this.identity=null,I=null,!0))}getArbitrarySignature(t,e,n="",r=!1){return j(o.i,{publicKey:t,data:e,whatfor:n,isHash:r},!0)}}e.default=new class{constructor(){const t=new r.EncryptedStream(i.a,s.a.text(64));t.listenWith(e=>{e&&e.hasOwnProperty("type")&&e.type===o.g&&(window.scatter=new N(t,e.payload))}),t.sync(i.b,t.key)}}}]);